{% extends "base_commerce.html" %}
{% load static %}
{% block page_header %}Analyse de la Mortalité{% endblock %}

{% block content %}
<div class="info-cards">
    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon"><i class="fas fa-skull"></i></div>
            <div class="info-card-title">Mortalité Totale</div>
        </div>
        <div class="info-card-value">{{ total_mortalite }} colonies</div>
    </div>
    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon"><i class="fas fa-archive"></i></div>
            <div class="info-card-title">Colonies Totales</div>
        </div>
        <div class="info-card-value">{{ total_colonies }} colonies</div>
    </div>
    <div class="info-card">
        <div class="info-card-header">
            <div class="info-card-icon"><i class="fas fa-chart-line"></i></div>
            <div class="info-card-title">Taux de Mortalité</div>
        </div>
        <div class="info-card-value" style="color: var(--queen-red);">{{ taux_mortalite }}%</div>
    </div>
</div>

<div class="elevage-card" style="margin-top: 2rem;">
    <h2>Évolution de la mortalité par mois</h2>
    <div class="chart-container" style="height: 50vh;">
        <canvas id="mortaliteChart"></canvas>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    new Chart(document.getElementById('mortaliteChart'), {
        type: 'line',
        data: {
            labels: {{ labels|safe }},
            datasets: [{
                label: 'Nombre de colonies perdues',
                data: {{ values|safe }},
                fill: false,
                borderColor: 'rgb(220, 53, 69)',
                tension: 0.1
            }]
        },
        options: { responsive: true, maintainAspectRatio: false }
    });
</script>
{% endblock %}